# Metadata of 15,051 protein chains 

This metadata file reports the number of sequence homologs for protein chains used as input into the recent `trRosetta` paper by Yang et al. (2020). They are also known as the number of sequences (N) of a MSA. 

## Provenance 

These chain-specific sequence homologs / MSA are obtained by a two-step procedure.

1. Perform series of filtering steps on 94,962 chains in PDB (redundancy removal, keeping only chains with high-resolution true contact maps, etc.)
2. Collect sequence homologs (aka, generate MSAs) using five different methods. 

Details are in the Methods section of the Yang et al. (2020) (paper)[https://www.pnas.org/content/117/3/1496].

## Summary Statistics 

We summarize the number of sequences, N, in each MSA in a text file, `sizes.txt`. 

- First column reports N for that protein chain
- Second column reports the particular chain's identity
- Third column reports the count category to which the chain belongs. The code is 
    - 1 = less than 1e3
    - 2 = between 1e3 and 1e4
    - 3 = between 1e4 and 1e5
    - 4 = larger than or equal to 1e5  

We provide protein chain ID files for each category, which can be used for filtering in downstream tasks.

**Quick summary** 

Most chains have between 1000 and 10,000 homologs:

```
    1     2     3     4 
 1627 10654  2770     1 
```

Finally, here is R code we use:

```
## Generate summary statistics
# Load libraries
library(tidyverse) # for piping
library(data.table) # for fwrite and fread

# Read sizes file 
sizes <- fread("sizes.txt") # sizes.txt generated by wc -l * in the directory contaiing all MSAs
names(sizes) <- c("num_seq", "seq_id")
sizes$num_seq <- sizes$num_seq/2

# Check if number of sequences is whole number
is.wholenumber <- function(x, tol = .Machine$double.eps^0.5)  abs(x - round(x)) < tol
any(!is.wholenumber(sizes$num_seq)) # all sizes are whole numbers --> good

# Categorize each protein chain
sizes$mag <- sapply(sizes$num_seq, function(x) {
  case_when(x < 1e3 ~ 1,
            x < 1e4 ~ 2,
            x < 1e5 ~ 3, 
            TRUE ~ 4)
})

# Save metadata
fwrite(sizes, file = "sizes.txt", sep = "\t")

# Save IDs of protein chains based on category
for (i in 1:4) {
  fwrite(sizes %>% filter(mag == i) %>% select(seq_id), 
         file = paste0("sizes_",i,".txt"), 
         sep = "\t", col.names = FALSE)
}
```